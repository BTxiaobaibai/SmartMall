"use strict";(self["webpackChunkheima_shopping"]=self["webpackChunkheima_shopping"]||[]).push([[619],{7867:function(t,s,a){a.d(s,{Bq:function(){return e},_P:function(){return n},d$:function(){return i}});var o=a(5720);const i=t=>o.A.get("/goods/list",{params:t}),n=t=>o.A.get("/goods/detail",{params:{goodsId:t}}),e=({goodsId:t,limit:s})=>o.A.get("/comment/listRows",{params:{goodsId:t,limit:s}})},8619:function(t,s,a){a.r(s),a.d(s,{default:function(){return v}});a(4114);var o=function(){var t=this,s=t._self._c;return t.detail.goods_name?s("div",{staticClass:"goodslist-detail"},[s("van-nav-bar",{attrs:{title:"商品详情","left-arrow":"",fixed:""},on:{"click-left":function(s){return t.$router.go(-1)}}}),s("van-swipe",{on:{change:t.onChange},scopedSlots:t._u([{key:"indicator",fn:function(){return[s("div",{staticClass:"custom-indicator"},[t._v(t._s(t.current+1)+"/"+t._s(t.images.length))])]},proxy:!0}],null,!1,1894612691)},t._l(t.images,function(t){return s("van-swipe-item",{key:t.external_url},[s("img",{attrs:{src:t.external_url,alt:""}})])}),1),s("div",{staticClass:"salse-data"},[s("div",{staticClass:"price"},[s("span",{staticClass:"new"},[t._v("￥"+t._s(t.detail.goods_price_min))]),s("span",{staticClass:"old"},[t._v("￥"+t._s(t.detail.line_price_max))])]),s("div",{staticClass:"count"},[t._v("已售"+t._s(t.detail.goods_sales)+"件")])]),s("p",{staticClass:"title"},[t._v(t._s(t.detail.goods_name))]),s("div",{staticClass:"sales-return"},[s("div",[s("van-icon",{attrs:{name:"passed",color:"#fa5d49"}}),s("span",[t._v("七天无理由退货")]),s("van-icon",{attrs:{name:"passed",color:"#fa5d49"}}),s("span",[t._v("48小时发货")])],1),s("van-icon",{attrs:{name:"arrow"}})],1),s("div",{staticClass:"comment"},[s("div",{staticClass:"top"},[s("div",{staticClass:"commleft"},[t._v("商品评价（"+t._s(t.commentsData.total)+"条）")]),s("div",{staticClass:"commright",on:{click:function(s){return t.$router.push(`/comment/${t.$route.params.id}`)}}},[s("span",[t._v("查看更多")]),s("van-icon",{attrs:{name:"arrow",color:"#9ea1a6"}})],1)]),s("div",{staticClass:"under"},t._l(t.commentsList,function(a){return s("div",{key:a.create_time,staticClass:"under-list"},[s("div",{staticClass:"usermsg"},[s("img",{attrs:{src:a.user.avatar_url,alt:""}}),s("span",[t._v(t._s(a.user.nick_name))]),s("van-rate",{attrs:{value:a.score/2,"allow-half":"","void-icon":"star","void-color":"#eee",color:"#ffd21e",readonly:""}})],1),s("p",{staticClass:"commcontent"},[t._v(t._s(a.content))]),s("p",{staticClass:"time"},[t._v(t._s(a.create_time))])])}),0)]),s("div",{staticClass:"introduce-title"},[t._v("商品描述")]),s("div",{staticClass:"goods-introduce",domProps:{innerHTML:t._s(t.detail.content)}}),s("van-goods-action",[s("van-goods-action-icon",{attrs:{icon:"wap-home-o",text:"首页"},on:{click:function(s){return t.$router.push("/home")}}}),s("van-goods-action-icon",{attrs:{icon:"shopping-cart-o",text:"购物车",badge:t.cartTotal>0?"cartTotal":""},on:{click:function(s){return t.$router.push("/cart")}}}),s("van-goods-action-button",{attrs:{type:"warning",text:"加入购物车"},on:{click:t.addCart}}),s("van-goods-action-button",{attrs:{type:"danger",text:"立即购买"},on:{click:t.buyNow}})],1),s("van-action-sheet",{attrs:{title:"cart"===t.clickData?"加入购物车":"立即购买"},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[s("div",{staticClass:"content"},[s("div",{staticClass:"header"},[s("div",{staticClass:"left"},[s("img",{attrs:{src:t.detail.goods_image,alt:""}})]),s("div",{staticClass:"right"},[s("p",{staticClass:"price"},[t._v("￥"+t._s(t.detail.goods_price_min))]),s("p",{staticClass:"save-count"},[t._v("库存"+t._s(t.detail.stock_total))])])]),s("div",{staticClass:"body"},[s("span",[t._v("数量")]),s("span",[s("CountBox",{model:{value:t.buyCount,callback:function(s){t.buyCount=s},expression:"buyCount"}})],1)]),t.detail.stock_total>0&&"cart"===t.clickData?s("div",{staticClass:"btn-cart",on:{click:t.addCartFn}},[t._v("加入购物车")]):t.detail.stock_total>0&&"buyNow"===t.clickData?s("div",{staticClass:"btn-buy",on:{click:t.buyFn}},[t._v("立即购买")]):s("div",{staticClass:"btn-empty"},[t._v("商品已售罄")])])])],1):t._e()},i=[],n=a(7867),e=a(9652),c=a(1534),r=a(7167),d={name:"MyGoodsDetail",mixins:[r.A],data(){return{current:0,detail:"",commentsData:"",commentsList:"",show:!1,clickData:"cart",buyCount:1,cartTotal:0}},async created(){const t=await(0,n._P)(this.$route.params.id);console.log(t),this.detail=t.data.detail;const s=await(0,n.Bq)({goodsId:this.$route.params.id,limit:3});this.commentsList=s.data.list,this.commentsData=s.data},methods:{onChange(t){this.current=t},addCart(){this.clickData="cart",this.show=!0},buyNow(){this.clickData="buyNow",this.show=!0},async addCartFn(){const t=await this.loginConfirm();if(t)return;const{data:s}=await(0,e.mk)({goodsId:this.detail.goods_id,goodsNum:this.buyCount,goodsSkuId:this.detail.skuList[0].goods_sku_id});this.cartTotal=s.cartTotal,this.show=!1,this.$toast("加入成功")},async buyFn(){const t=await this.loginConfirm();t||this.$router.push({path:"/pay",query:{mode:"buyNow",goodsId:this.goodsId,goodsSkuId:this.detail.skuList[0].goods_sku_id,goodsNum:this.buyCount}})}},computed:{images(){return this.detail.goods_images},goodsId(){return this.$route.params.id}},components:{CountBox:c.A}},l=d,u=a(1656),m=(0,u.A)(l,o,i,!1,null,"02be8fc0",null),v=m.exports}}]);
//# sourceMappingURL=619.a1657a7d.js.map